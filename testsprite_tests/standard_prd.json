{
  "meta": {
    "project": "LLM Quiz Game",
    "date": "2026-02-21",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "Multiplayer quiz web app focused on LLM/AI topics built with Next.js and SSE for real-time gameplay. Players register/login, join or create rooms, play timed quizzes, and view results while admins can supervise live games.",
  "core_goals": [
    "Provide secure user authentication with HTTP-only session cookies.",
    "Allow admin users to create and manage multiplayer quiz rooms.",
    "Deliver real-time, low-latency game state and leaderboard updates using Server-Sent Events (SSE).",
    "Show deterministic final results and per-question breakdowns after each game.",
    "Offer a read-only admin supervision view for monitoring live games."
  ],
  "features": [
    {
      "name": "User Login",
      "description": "Allow existing users to authenticate with username and password (Spanish UI). Successful login sets an HTTP-only session cookie and redirects to the home page.",
      "user_flows": [
        "Navigate to /login -> Fill 'Nombre de usuario' input field with username -> Fill 'Contraseña' input field with password -> Click 'Iniciar Sesión' button to submit -> See 'Iniciando sesión...' loading state -> Browser sends POST to /api/auth/login -> Receive success response and auth_session cookie -> Redirected to home page (/)",
        "Navigate to /login -> Fill 'Nombre de usuario' input field with username -> Fill 'Contraseña' input field with incorrect password -> Click 'Iniciar Sesión' button to submit -> See 'Iniciando sesión...' loading state -> Browser sends POST to /api/auth/login -> Receive 401/invalid response -> See generic error message (no user enumeration)"
      ]
    },
    {
      "name": "User Registration",
      "description": "Create a new account with username, email and password. The first registered user becomes admin. Field-level validation prevents common errors.",
      "user_flows": [
        "Navigate to /register -> Fill 'Nombre de usuario' input (3-20 chars, alphanumeric or underscores) -> Fill 'Correo electrónico' input with valid email -> Fill 'Contraseña' input meeting password requirements -> Fill 'Confirmar contraseña' input matching password -> Click 'Registrarse' button to submit -> See 'Creando cuenta...' loading state -> Browser sends POST to /api/auth/register -> Receive success response and auth_session cookie -> Redirected to home page (/)",
        "Navigate to /register -> Fill 'Nombre de usuario' input with an already-registered username -> Fill other fields validly -> Click 'Registrarse' button to submit -> See field-level validation error 'Nombre de usuario ya registrado' and form prevents submission"
      ]
    },
    {
      "name": "Room List and Creation",
      "description": "Home page lists available game rooms; admin users see a '+ Crear Sala' button to create new rooms. Room cards show status and participant count and users can join rooms.",
      "user_flows": [
        "Navigate to / -> See 'Bienvenido, {username}' greeting at top -> View list of room cards showing room name, status, participant count -> Click room card for {roomId} to join -> Browser sends POST to /api/rooms/{roomId}/join -> On success navigate to /rooms/{roomId}/play",
        "Navigate to / as admin -> See '+ Crear Sala' button -> Click '+ Crear Sala' button -> Fill room name field -> Fill participant limit field -> Click submit to create room -> Browser sends POST to /api/rooms -> See new room card appear in the room list",
        "Navigate to / -> Click room card for {roomId} when room is full or join request fails -> Browser sends POST to /api/rooms/{roomId}/join -> Receive error response -> See error message indicating join failed (e.g., 'Sala llena' or network error)"
      ]
    },
    {
      "name": "Game Play",
      "description": "Interactive timed quiz play inside a room: shows questions with four shuffled answers, a 30s countdown per question, optimistic answer submission, summary phase with correct answer, and live leaderboard via SSE.",
      "user_flows": [
        "Navigate to /rooms/{roomId}/play -> Connect to SSE stream via GET /api/rooms/{roomId}/game/stream -> See question text with 4 answer options (shuffled) -> See countdown timer start (30 seconds) -> Click an answer option to submit -> See optimistic UI feedback for selected answer -> Browser sends POST to /api/rooms/{roomId}/game/answer -> After answer or timer expiry see summary with correct answer highlighted -> See leaderboard with current scores during summary -> Observe progress bar increment and repeat through question 10 -> After last question see finished phase with final results -> Click to navigate to /rooms/{roomId}/results",
        "Navigate to /rooms/{roomId}/play -> Connect to SSE stream via GET /api/rooms/{roomId}/game/stream -> See question text and countdown -> Fail to submit answer due to network error when clicking option -> Browser attempts POST to /api/rooms/{roomId}/game/answer and receives error -> See error notification and option to retry or continue (answer not recorded) -> After timeout proceed to summary phase with unanswered state shown",
        "Navigate to /rooms/{roomId}/play -> SSE stream disconnects mid-game -> See 'Conexión perdida' or reconnection UI -> Client attempts to resubscribe to GET /api/rooms/{roomId}/game/stream -> On successful reconnection receive missed state updates and resume play"
      ]
    },
    {
      "name": "Game Results",
      "description": "After a game finishes, a results page shows the final leaderboard and a per-question breakdown (correctness, difficulty, category).",
      "user_flows": [
        "Navigate to /rooms/{roomId}/results -> Browser sends GET to /api/rooms/{roomId}/game/results -> See final leaderboard with rankings and scores -> See per-question breakdown showing correctness, difficulty, and category -> Click control to return to home -> Navigate to /",
        "Navigate to /rooms/{roomId}/results -> Browser sends GET to /api/rooms/{roomId}/game/results -> Receive 404 or network error -> See error message 'Resultados no disponibles' -> Click to return to home -> Navigate to /"
      ]
    },
    {
      "name": "Admin Supervision",
      "description": "Admin-only read-only live view to monitor an ongoing game with current question visibility and a real-time leaderboard via SSE.",
      "user_flows": [
        "Navigate to /rooms/{roomId}/supervise -> Connect to SSE stream via GET /api/rooms/{roomId}/game/stream -> See current question and answer options (read-only) -> See live leaderboard with real-time score updates -> See game phase and progress indicator (admin cannot submit answers)",
        "Navigate to /rooms/{roomId}/supervise as non-admin -> Attempt to load supervise page -> Receive authorization failure or redirect -> See access denied message or redirected to home (/)"
      ]
    }
  ],
  "code_summary": {
    "version": "2",
    "type": "frontend",
    "tech_stack": [
      "TypeScript 5",
      "Next.js 16 (App Router)",
      "React 19",
      "Tailwind CSS 4",
      "Server-Sent Events (SSE) for real-time updates"
    ],
    "routes": [
      {
        "path": "/login",
        "file": "app/(auth)/login/page.tsx",
        "auth_required": false,
        "description": "User login page with username and password fields (Spanish UI)"
      },
      {
        "path": "/register",
        "file": "app/(auth)/register/page.tsx",
        "auth_required": false,
        "description": "User registration page with username, email, password, confirmPassword fields (Spanish UI)"
      },
      {
        "path": "/",
        "file": "app/page.tsx",
        "auth_required": true,
        "description": "Home page showing room list and create room button (admin only)"
      },
      {
        "path": "/rooms/{roomId}/play",
        "file": "app/rooms/[roomId]/play/page.tsx",
        "auth_required": true,
        "description": "Game play page with question/summary/finished phases and real-time SSE updates"
      },
      {
        "path": "/rooms/{roomId}/results",
        "file": "app/rooms/[roomId]/results/page.tsx",
        "auth_required": true,
        "description": "Game results page with leaderboard and per-question breakdown"
      },
      {
        "path": "/rooms/{roomId}/supervise",
        "file": "app/rooms/[roomId]/supervise/page.tsx",
        "auth_required": true,
        "description": "Admin-only live monitoring view of a game in progress"
      }
    ],
    "features": [
      {
        "name": "User Login",
        "description": "Login with username and password. Sets HTTP-only auth_session cookie. Redirects to home on success.",
        "files": [
          "app/(auth)/login/page.tsx",
          "components/auth/LoginForm.tsx"
        ],
        "entry_route": "/login",
        "user_interactions": [
          "Fill 'Nombre de usuario' input field with username",
          "Fill 'Contraseña' input field with password",
          "Click 'Iniciar Sesión' button to submit",
          "See error message on invalid credentials (generic, no user enumeration)",
          "See 'Iniciando sesión...' loading state during submission",
          "Redirected to home page (/) on successful login",
          "Click 'Registrarse' link to navigate to registration"
        ],
        "api_calls": [
          {
            "method": "POST",
            "endpoint": "/api/auth/login"
          }
        ],
        "auth_required": false
      },
      {
        "name": "User Registration",
        "description": "Create new account with username, email, password, and confirmPassword. First user becomes admin.",
        "files": [
          "app/(auth)/register/page.tsx",
          "components/auth/RegisterForm.tsx",
          "components/auth/PasswordInput.tsx",
          "components/auth/PasswordRequirements.tsx"
        ],
        "entry_route": "/register",
        "user_interactions": [
          "Fill 'Nombre de usuario' input (3-20 chars, alphanumeric + underscores)",
          "Fill 'Correo electrónico' input with valid email",
          "Fill 'Contraseña' input (min 8 chars, shows password requirements)",
          "Fill 'Confirmar contraseña' input (must match password)",
          "Click 'Registrarse' button to submit",
          "See field-level validation errors (e.g., 'Nombre de usuario ya registrado')",
          "See 'Creando cuenta...' loading state during submission",
          "Redirected to home page (/) on successful registration",
          "Click 'Iniciar Sesión' link to navigate to login"
        ],
        "api_calls": [
          {
            "method": "POST",
            "endpoint": "/api/auth/register"
          }
        ],
        "auth_required": false
      },
      {
        "name": "Room List and Creation",
        "description": "View available game rooms on home page. Admin users see a create room button. Shows room cards with status, participant count, and join option.",
        "files": [
          "app/page.tsx",
          "components/rooms/RoomList.tsx",
          "components/rooms/RoomCard.tsx",
          "components/rooms/CreateRoomButton.tsx"
        ],
        "entry_route": "/",
        "user_interactions": [
          "See 'Bienvenido, {username}' greeting at top",
          "View list of room cards showing room name, status, participant count",
          "Click a room card to join or view details",
          "Admin sees '+ Crear Sala' button",
          "Admin clicks create button, enters room name and participant limit, submits",
          "Click 'Cerrar Sesión' (logout) button in header"
        ],
        "api_calls": [
          {
            "method": "GET",
            "endpoint": "/api/rooms"
          },
          {
            "method": "POST",
            "endpoint": "/api/rooms"
          },
          {
            "method": "POST",
            "endpoint": "/api/rooms/{roomId}/join"
          }
        ],
        "auth_required": true
      },
      {
        "name": "Game Play",
        "description": "Interactive quiz game with timed questions, answer selection, summary phases, and real-time leaderboard via SSE.",
        "files": [
          "app/rooms/[roomId]/play/page.tsx",
          "components/game/GamePlay.tsx",
          "components/game/QuestionPhase.tsx",
          "components/game/SummaryPhase.tsx",
          "components/game/FinishedPhase.tsx",
          "components/game/TimerDisplay.tsx",
          "components/game/ProgressBar.tsx",
          "components/game/Leaderboard.tsx"
        ],
        "entry_route": "/rooms/{roomId}/play",
        "user_interactions": [
          "See question text with 4 answer options (shuffled per room)",
          "See countdown timer (30 seconds per question)",
          "Click an answer option to submit (optimistic UI feedback)",
          "See progress bar showing question number out of 10",
          "After answering or timeout, see summary with correct answer highlighted",
          "See leaderboard with current scores during summary",
          "After 10 questions, see finished phase with final results",
          "Click to navigate to results page"
        ],
        "api_calls": [
          {
            "method": "GET",
            "endpoint": "/api/rooms/{roomId}/game"
          },
          {
            "method": "POST",
            "endpoint": "/api/rooms/{roomId}/game/answer"
          },
          {
            "method": "GET",
            "endpoint": "/api/rooms/{roomId}/game/stream"
          }
        ],
        "auth_required": true
      },
      {
        "name": "Game Results",
        "description": "Final results page showing leaderboard and per-question breakdown after game finishes.",
        "files": [
          "app/rooms/[roomId]/results/page.tsx",
          "components/game/ResultsView.tsx"
        ],
        "entry_route": "/rooms/{roomId}/results",
        "user_interactions": [
          "See final leaderboard with rankings and scores",
          "See per-question breakdown showing correctness, difficulty, category",
          "Navigate back to home page"
        ],
        "api_calls": [
          {
            "method": "GET",
            "endpoint": "/api/rooms/{roomId}/game/results"
          }
        ],
        "auth_required": true
      },
      {
        "name": "Admin Supervision",
        "description": "Admin-only read-only view to monitor a game in progress with live leaderboard and question visibility.",
        "files": [
          "app/rooms/[roomId]/supervise/page.tsx",
          "components/game/AdminSupervision.tsx"
        ],
        "entry_route": "/rooms/{roomId}/supervise",
        "user_interactions": [
          "See current question and answer options (read-only, cannot answer)",
          "See live leaderboard with real-time score updates",
          "See game phase and progress"
        ],
        "api_calls": [
          {
            "method": "GET",
            "endpoint": "/api/rooms/{roomId}/game"
          },
          {
            "method": "GET",
            "endpoint": "/api/rooms/{roomId}/game/stream"
          }
        ],
        "auth_required": true
      }
    ],
    "known_limitations": [
      {
        "issue": "Game play requires minimum 2 participants and real-time SSE, which may be difficult to test with a single browser session",
        "location": "components/game/GamePlay.tsx",
        "impact": "Full game flow testing requires multi-user coordination"
      },
      {
        "issue": "All UI text is in Spanish; no i18n system - strings are hardcoded",
        "location": "components/",
        "impact": "Tests must use Spanish text for assertions and interactions"
      }
    ]
  }
}
